# example.com の設定
server {
	# HTTPSリスニング設定
	listen		443 ssl http2;
	listen	[::]:443 ssl http2;
	server_name	\'${DOMAIN_NAME}\';

	# SSL設定
	ssl_certificate /etc/ssl/certs/nginx.crt;
	ssl_certificate_key /etc/ssl/private/nginx.key;
	ssl_protocols       TLSv1.3 TLSv1.2;
	ssl_ciphers         HIGH:!aNULL:!MD5;
	ssl_prefer_server_ciphers on;
	ssl_session_cache   shared:SSL:10m;
	ssl_session_timeout 10m;
	ssl_session_tickets off;

	# セキュリティヘッダーの追加
	add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
	add_header X-Content-Type-Options "nosniff" always;
	add_header X-Frame-Options "DENY" always;
	add_header X-XSS-Protection "1; mode=block" always;

	# ルートディレクトリ設定
	location / {
		proxy_pass http://wordpress:9000; # WordPressコンテナに接続
		proxy_set_header Host $host;
		proxy_set_header X-Real-IP $remote_addr;
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header X-Forwarded-Proto $scheme;
	}

#	# ルートディレクトリ設定
#	location / {
#		root   /usr/share/nginx/html;
#		index  index.html index.htm;
#		try_files $uri $uri/ =404;
#	}

	# カスタムエラーページ
	error_page   500 502 503 504 /50x.html;
	location = /50x.html {
		root   /usr/share/nginx/html;
	}

	# 無効なリクエストを制限
	location ~ /\.ht {
		deny all;
	}
}
